# ADR-0001: تبديل الواجهة الافتراضية إلى المحرر المتقدم

## الحالة
مقبول

## السياق
يحتوي المشروع حالياً على واجهتين رئيسيتين:
1. **NaqidDashboard**: واجهة تحليل سريع (الحالية)
2. **CleanIntegratedScreenplayEditor**: محرر سيناريو متقدم (غير مفعل)

الواجهة الحالية (NaqidDashboard) محدودة الوظائف وتركز على التحليل فقط، بينما المحرر المتقدم يوفر تجربة كتابة شاملة مع أدوات متقدمة.

## القرار
تبديل الواجهة الافتراضية من NaqidDashboard إلى CleanIntegratedScreenplayEditor كواجهة رئيسية للتطبيق.

## الدوافع

### 1. تجربة مستخدم أفضل
- **المحرر المتقدم** يوفر تجربة كتابة متكاملة
- **أدوات تحرير متقدمة**: بحث، استبدال، تنسيق تلقائي
- **دعم RTL كامل**: محسن للكتابة العربية
- **واجهة حديثة**: تصميم أنيق ومتجاوب

### 2. وظائف أكثر شمولية
- **تحرير مباشر**: كتابة وتحرير فوري
- **تنسيقات متعددة**: دعم جميع عناصر السيناريو
- **حفظ تلقائي**: حماية من فقدان البيانات
- **تصدير متعدد**: PDF، Word، HTML

### 3. تكامل أفضل مع الوكلاء
- **وصول مباشر**: للوكلاء الذكية من المحرر
- **تطبيق فوري**: للاقتراحات والتحسينات
- **سياق أفضل**: الوكلاء تعمل على النص الحالي

### 4. قابلية التوسع
- **بنية مرنة**: سهولة إضافة ميزات جديدة
- **نظام المكونات**: قابل للتخصيص والتوسع
- **API موحد**: للتفاعل مع الخدمات الخارجية

## البدائل المدروسة

### البديل 1: الاحتفاظ بـ NaqidDashboard
**المزايا:**
- استقرار الواجهة الحالية
- عدم الحاجة لتغييرات كبيرة
- واجهة بسيطة للمبتدئين

**العيوب:**
- وظائف محدودة
- تجربة مستخدم أقل
- عدم استغلال الإمكانيات الكاملة

### البديل 2: دمج الواجهتين
**المزايا:**
- الاستفادة من مزايا كلا الواجهتين
- مرونة في الاستخدام

**العيوب:**
- تعقيد إضافي في التطوير
- تشتت تجربة المستخدم
- صعوبة الصيانة

### البديل 3: إعادة كتابة كاملة
**المزايا:**
- تصميم مثالي من الصفر
- تحسين شامل للأداء

**العيوب:**
- وقت تطوير طويل
- مخاطر عالية
- فقدان الوظائف الحالية

## التأثيرات

### الإيجابية
1. **تحسين تجربة المستخدم**: واجهة أكثر احترافية
2. **زيادة الإنتاجية**: أدوات تحرير متقدمة
3. **استغلال أفضل للوكلاء**: تكامل محسن
4. **جاذبية أكبر**: للمستخدمين المحترفين

### السلبية
1. **منحنى تعلم**: قد يحتاج المستخدمون وقت للتكيف
2. **تعقيد أكبر**: واجهة أكثر تفصيلاً
3. **استهلاك موارد**: أعلى من الواجهة البسيطة

## خطة التنفيذ

### المرحلة 1: التحضير
```typescript
// 1. تحديث App.tsx
- import { NaqidDashboard } from './components/naqid/NaqidDashboard';
+ import { CleanIntegratedScreenplayEditor } from './components/editor/CleanIntegratedScreenplayEditor';

export default function App() {
-  return <NaqidDashboard />;
+  return <CleanIntegratedScreenplayEditor />;
}
```

### المرحلة 2: إضافة تبديل اختياري
```typescript
// إضافة خيار للتبديل بين الواجهتين
const [editorMode, setEditorMode] = useState<'advanced' | 'simple'>('advanced');

return editorMode === 'advanced' 
  ? <CleanIntegratedScreenplayEditor />
  : <NaqidDashboard />;
```

### المرحلة 3: تحسين التكامل
- ربط لوحة التحليل كجزء من المحرر المتقدم
- نقل الوظائف المفيدة من NaqidDashboard
- تحسين الأداء والاستجابة

## المخاطر وخطة التخفيف

### المخاطر المحتملة

#### 1. مقاومة المستخدمين للتغيير
**التخفيف:**
- توفير دليل استخدام شامل
- إضافة نصائح تفاعلية
- الاحتفاظ بخيار الواجهة البسيطة

#### 2. مشاكل في الأداء
**التخفيف:**
- اختبار شامل للأداء
- تحسين التحميل التدريجي
- مراقبة استهلاك الذاكرة

#### 3. أخطاء في الوظائف
**التخفيف:**
- اختبار مكثف قبل النشر
- نظام تقارير الأخطاء
- خطة تراجع سريعة

### خطة التراجع

#### في حالة فشل التبديل:
```bash
# العودة للنسخة السابقة
git revert <commit-hash>

# أو التبديل المؤقت في الكود
const USE_ADVANCED_EDITOR = false; // تغيير إلى false
```

#### معايير التراجع:
- أخطاء حرجة تمنع الاستخدام
- انخفاض الأداء بأكثر من 50%
- شكاوى مستخدمين تزيد عن 30%

## المقاييس والمراقبة

### مقاييس النجاح
1. **وقت التحميل**: < 3 ثواني
2. **معدل الاستخدام**: > 80% للميزات الجديدة
3. **رضا المستخدمين**: > 4/5 في الاستبيانات
4. **معدل الأخطاء**: < 1% من الجلسات

### أدوات المراقبة
- Google Analytics للاستخدام
- Sentry لمراقبة الأخطاء
- Performance API للأداء
- استبيانات دورية للمستخدمين

## الجدول الزمني

| المرحلة | المدة | المهام |
|---------|-------|---------|
| التحضير | يوم 1 | تحديث الكود الأساسي |
| الاختبار | يوم 2-3 | اختبار شامل للوظائف |
| النشر التدريجي | يوم 4-5 | نشر لمجموعة محدودة |
| النشر الكامل | يوم 6 | نشر لجميع المستخدمين |
| المراقبة | أسبوع 1-2 | مراقبة الأداء والتغذية الراجعة |

## التوقيعات

- **صاحب القرار**: مهندس النظام الرئيسي
- **تاريخ القرار**: 2024-01-15
- **المراجعة التالية**: 2024-02-15

## المراجعات

### مراجعة شهر واحد (2024-02-15)
- تقييم نجاح التبديل
- جمع تغذية راجعة من المستخدمين
- تحديد التحسينات المطلوبة

### مراجعة ثلاثة أشهر (2024-04-15)
- تحليل شامل للأداء
- قرار نهائي حول الاحتفاظ بالتغيير
- خطة التطوير المستقبلي

هذا القرار يهدف إلى تحسين تجربة المستخدم وتوفير أدوات أكثر قوة لكتابة السيناريوهات العربية، مع الحفاظ على إمكانية التراجع في حالة ظهور مشاكل غير متوقعة.